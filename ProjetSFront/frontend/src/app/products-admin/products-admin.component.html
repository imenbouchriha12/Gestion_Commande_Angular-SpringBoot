<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <!-- Barre de Recherche -->

    <ul class="navbar-nav" style="margin-left: 0;">
      <li class="nav-item active">
        <a class="nav-link" href="/productsAdmin">
          <i class="pi pi-box" style="margin-right: 8px;"></i> Articles
        </a>
      </li>
           <li class="nav-item">
        <a class="nav-link" href="/commandesAdmin">
          <i class="pi pi-cart" style="margin-right: 8px;"></i> Consulter Les Commandes
        </a>
      </li>
<li class="nav-item">
  <a class="nav-link"  (click)="logout()">
    <i class="pi pi-sign-out" style="margin-right: 8px;"></i> Se Déconnecter
  </a>
</li>

    </ul>
    

  </div>
</nav>


<div class="m-4">
<!-- Bouton Ajouter -->
<button type="button" class="btn btn-success mb-3" (click)="openNew()">Ajouter Un Produit</button>

<!-- Bouton Supprimer Sélection -->
<button type="button" class="btn btn-danger mb-3 ml-2"
        [disabled]="!selectedProducts || selectedProducts.length === 0"
        (click)="deleteSelectedProducts()">Supprimer La Selection</button>

  <form class="d-flex" (submit)="onSearch()">
  <input class="form-control form-control-sm mr-3" type="search" placeholder="Rechercher des articles" aria-label="Search" [(ngModel)]="searchQuery" name="searchQuery">
  <button class="btn btn-outline-success btn-sm" type="submit">
    <i class="pi pi-search"></i> Rechercher
  </button>
</form>


<!-- Tableau Produits -->
<div class="container mt-5">
  <div class="row">
    <div class="col-lg-4 col-md-6 col-sm-12" *ngFor="let product of filteredProducts; let i = index">
      <div class="card mb-4" style="border-radius: 10px;">
        <div class="card-body">
          <!-- Bande catégorie en haut de la carte -->
          <div class="category-banner" style="background-color: #f8f9fa; padding: 5px 10px; border-radius: 5px 5px 0 0;">
            <span class="text-muted" style="font-weight: bold;">{{ product.categorie }}</span>
          </div>

          <!-- Checkbox dans le coin supérieur gauche -->
          <div class="form-check" style="position: absolute; top: 10px; left: 10px;">
            <input type="checkbox"
                   [(ngModel)]="product.selected"
                   (change)="updateSelectedProducts()"
                   class="form-check-input" />
          </div>

          <!-- Image du produit -->
          <img [src]="productImages[i]" class="card-img-top" alt="product" style="height: 200px; object-fit: cover; border-radius: 5px;" />

          <!-- Informations produit -->
          <h5 class="card-title mt-3">{{ product.nom }}</h5>
          <p class="card-text">{{ product.description }}</p>

          <!-- Prix et Stock -->
          <div class="d-flex justify-content-between">
            <span class="text-success">{{ product.prix | currency }}</span>
<span 
  class="badge" 
  [ngClass]="{'bg-danger': product.stock === 0, 'bg-primary': product.stock > 0}">
  {{ product.stock === 0 ? 'Rupture de stock' : product.stock + ' en stock' }}
</span>
          </div>

          <!-- Boutons Modifier et Supprimer -->
          <div class="d-flex justify-content-between mt-3">
            <button class="btn btn-warning" (click)="editProducts(product)">
              <i class="pi pi-pencil"></i> Modifier
            </button>
            <button class="btn btn-danger" (click)="deleteProduct(product)">
              <i class="pi pi-trash"></i> Supprimer
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


  <!-- Dialog Formulaire Ajouter/Modifier -->
  <div *ngIf="productDialog" class="modal" style="display: block;">
    <div class="modal-content">
      <span class="close" (click)="hideDialog()">&times;</span>
      <h3>Formulaire Du Produit</h3>
      <form (ngSubmit)="saveProduct()" #productForm="ngForm">
        <div class="form-group">
          <label for="nom">Nom</label>
          <input id="nom" type="text" [(ngModel)]="product.nom" name="nom" required class="form-control" />
        </div>
  
        <div class="form-group">
          <label for="categorie">Catégorie</label>
          <input id="categorie" type="text" [(ngModel)]="product.categorie" name="categorie" required class="form-control" />
        </div>
  
  
        <div class="form-group">
          <label for="prix">Prix</label>
          <input id="prix" type="text" [(ngModel)]="product.prix" name="prix" required class="form-control" />
        </div>
  
        <div class="form-group">
          <label for="stock">Stock</label>
          <input id="stock" type="text" [(ngModel)]="product.stock" name="stock" required class="form-control" />
        </div>

          <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" [(ngModel)]="product.description" name="description" class="form-control"></textarea>
        </div>
  
        <div class="form-group">
          <label for="photo">Photo</label>
          <input id="photo" type="file" (change)="onFileSelected($event)" class="form-control" />
          <img [src]="imageSource" alt="Selected" width="100" class="mt-2" *ngIf="imageSource" />
        </div>
  
        <div class="form-group">
          <button type="submit" class="btn btn-success" [disabled]="!productForm.valid">Enregistrer</button>
          <button type="button" class="btn btn-secondary" (click)="hideDialog()">Annuler</button>
        </div>
      </form>
    </div>
  </div>
  